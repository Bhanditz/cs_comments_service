sudo: false

language: ruby

rvm:
  - "1.9.3"

cache: bundler

services:
  - docker

before_install:
  - gem update bundler # Ensure we use the latest version of bundler. Travis' default version of outdated.

  # Run Elasticsearch as a daemon
  - curl -OL https://download.elasticsearch.org/elasticsearch/elasticsearch/elasticsearch-2.3.5.zip
  - unzip elasticsearch-2.3.5.zip
  - elasticsearch-2.3.5/bin/elasticsearch -d

  # Run MongoDB as a daemon
  - curl -O https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.6.11.tgz
  - tar -zxf mongodb-linux-x86_64-2.6.11.tgz
  - export PATH=mongodb-linux-x86_64-2.6.11/bin:$PATH
  - mkdir -p ./mongo/db
  - mkdir -p ./mongo/log
  - mongod --fork --dbpath ./mongo/db --logpath ./mongo/log/mongodb.log

script:
  - bin/rake search:initialize
  - bin/rspec
